#summary A guide on how to use the SiteParser to add your site to OnlineVideos.
= Table of Contents =
<wiki:toc max_depth="2" />

= Introduction =

The SiteParser is a tool that can be used for creating the necessary configuration parameters to add to the OnlineVideoSites.xml

You can start the siteparser by clicking this <img width="16" src="http://mp-onlinevideos2.googlecode.com/svn/trunk/OnlineVideos.MediaPortal1/Resources/CreateSite.png"/> button in the Online Videos Configuration, Sites-Tab
Or start the program "Onlinevideos.SiteCreator" in the Mediaportal Installation directory

= Description =

A website in OnlineVideos consists of Categories, optional Subcategories, and Videolists.
For each of these, the way of getting the correct information into OnlineVideos must be configured. Therefore, on the main screen, there are sections on which to create/test their configuration settings.

First of all, and the most important one is the baseurl: That must be the URL that holds the categories you want to have in the OnlineVideos.
Most of the time, this is the URL you type in your browser if you want to watch videos. However, sometimes this is buried a little deeper, and you have to use some other means to get that URL (e.g. fiddler).

Once you have put the baseurl into it's place, you are ready to find the categories.
Click the "Create Regex" button in the Categories section [http://code.google.com/p/mp-onlinevideos2/wiki/CreateRegex explanation], and start creating the Regex for it.
If you are ready with it, click on the "GetCats" button, and you'll see a "+" appearing at the right side (just left of "-site")

Expand that "+", and select some categories and see if the results at the bottom of the screen are satisfactory.
If not, you can change the URL-format, and enable URL-decoding if necessary. After changing those, you need to click on "GetCats" to see the updated results.

After the categories are correctly configured, you can do the same for subcategories if present. If not, go to the "VideoList".

VideoList:
Under site (at the right side) you have to select a Category or Subcategory.
Then create the regex for the videos.

When that one is created click on the "GetVideoList", and you'll see a "+" appearing at the right side, just left of the category/subcategory selected.

VideoUrl:
This is a 3-step process:

1: "GetVideoUrl" here you can transform the url from the VideoList to a more suitable string (not necessary a valid url) e.g. extract the id from the url

You can use m0,m1 and so on to extract the parts that are needed, and they will be filled into the {0},{1} etc in the VideoUrlFormatString
example:
{{{
Url from VideoList: http://www.website.com/video/today/706334
VideoUrlRegex: http://.+/(?<m0>\d{4,10}) (this results in m0=706334)
VideoUrlFormatString: http://www.website.com/flash/download?&movieId={0}
VideoUrlResult: http://www.website.com/flash/download?&movieId=706334
}}}

2: "GetPlayListUrl" to be documented

3: "GetFileUrl" here you can parse the html-result of the previous steps to extract the final url.
Here you can also use the m0,m1, etc as explained in step 1.


= Menu Items =

 * File, Load Sites: Opens an existing OnlineVideoSites.xml for further testing/editing
 * ChoiceBox: If a file is opened, you can choose the site you want to test/edit
 * Load: loads the configuration of the site selected in the choicebox
 * Copy: copy the current configuration parameters as xml to the clipboard (So that you can easily paste them in the OnlineVideoSites.xml

= Step by step (simple version) =

 # for baseurl: fill the URL of the page with the categories on it
 # click on "Create Regex" on the "Category" tab, and create the regex [http://code.google.com/p/mp-onlinevideos2/wiki/CreateRegex explanation]
 # click on "GetCats" on the "Category" tab. You should now see the categories listed under "site" at the right panel
 # if there are subcategories present then select a category, and goto the subcategories tab, if notL skip next step
 # click on "Create Regex" and after that on GetSubcats. then select a subcategory
 # goto the "VideoList" tab, and click on "Create Regex".
 # create the regex, and after that, click "GetVideoList"
 # now you should see the video's listed under the selected (sub)category
 # select a video, and click on the "VideoUrl" tab.
 # click "GetVideoUrl", click "GetPlaylistUrl" and click "Create Regex" next to "GetFileUrl"
 # create the regex
 # choose the URL under "ResultUrl" and hit the play-button to verify
 # click "Copy" in the main menu, open onlinevideosites.xml in your favourite texteditor, and paste the configuration in it. Then remove the categories (lines starting with <Category xsi:type="RssLink") that are to be dynamically discovered.
 # Save the file, and enjoy your new creation!
 # After the final approvement, you can publish the site through the onlinevideos configuration